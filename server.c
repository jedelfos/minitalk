#include <stdlib.h> 
/*#include <sys/types.h>
#include <unistd.h>
 #include <signal.h> 
#include <stdlib.h>
void handle_sigint(int sig)
{
    if (sig == 2)
        exit(0);
    printf("Caught signal %d\n", sig);
}

int main(int argv, char **argc)
{
    int pid;


    pid = getpid();

    printf("%i\n", pid);
    sigset_t masque;
    sigemptyset(&masque);
    sigaddset(&masque, 30);
    */
 /*
   	struct sigaction act;
    sigaction(30, &act, NULL);

    



    signal(SIGINT, handle_sigint);
    while(1)
    {
//        printf("%i                                         %i\n",signal(pid, 0),pid);
    }
    return 0;
}
*/

#include <stdio.h>
#include <unistd.h>
#include <signal.h>
#include <string.h>


static void signal_1(int sig)
{
    static int multi = 128;
    static int nb = 0;
    static int neg = 1;
    static char precedent [2];
    if (sig == 31 && multi == 128)
        neg = -1;
    else if (sig == 31)
        nb = nb + multi ;
//    printf ("%i    %i    %i  \n", multi, sig - 30, nb);

    if (multi == 1)
    {
        nb = nb * neg;
    	precedent[1] = nb;
        if (precedent[0] < 0)
        {
            write(1, precedent, 2);
        //	write(1, "\n", 1);
            neg = 10;
            precedent [0] = 0;
        }
        else if (nb >= 0)
        {
            write(1, &nb, 1);
    	//    write(1, "\n", 1);
        }
        multi = 256;
        if (neg != 10)
            precedent [0] = nb;

        neg = 1;
        nb = 0;
    }
    multi = multi / 2;
//1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1231234567890----1234567890----1234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123123456789012345678901234567890123456789012345678901234567890123
//    printf ("%i\n",sig - 30);
//1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----1234567890----
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
}

/*
00110001
00110001
00110001
00110001
00110001
00110001
00110001

00110000
10110001
00110001
00110000
10110001
00110001
00110000
10110001
00110000
10110001





00110000
00110000
0110000
00110000
00110000
00110000
00110000
00110000
0110000
00110000
00110000
0110000
00110000
0110000
00110000
00110000
00110000
00110000
00110000
0110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
0110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
00110000
0110000

*/

//static void signal_2 (int sig, void *context)


void handle_sigint(int sig)
{
    if (sig == 2)
        exit(0);
    printf("Caught signal %d\n", sig);
}
 
int main (int argc, char *argv[])
{

//    int pid;
    printf("%i\n", getpid());
   char * str;
    
//    str = malloc(1000);
//    str = "test testestest ";
//	struct sigaction *act;
//	act = (struct sigaction *)malloc(sizeof(act));
//    act->sa_flags = SA_SIGINFO;
//act->sa_sigaction = &signal_1;
//	sigaction(30, &act[0], NULL);
//	act->sa_sigaction = &signal_2;
//	sigaction(31, &act[0], NULL);
    signal(30, signal_1);
    signal(31, signal_1);

	while (1)
		sleep (10);
 
	return 0;
}

